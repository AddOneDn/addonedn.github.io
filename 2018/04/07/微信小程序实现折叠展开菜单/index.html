<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content="微信小程序实现折叠展开菜单"><meta name="keywords" content="前端,微信小程序"><meta name="author" content="AddOneG,undefined"><meta name="copyright" content="AddOneG"><title>微信小程序实现折叠展开菜单 | AddOneG</title><link rel="shortcut icon" href="/favicon.ico"><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.staticfile.org/font-awesome/4.7.0/css/font-awesome.min.css?version=1.5.3"><link rel="dns-prefetch" href="https://cdn.staticfile.org"><link rel="dns-prefetch" href="https://cdn.bootcss.com"><link rel="dns-prefetch" href="https://creativecommons.org"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  localSearch: undefined
} </script></head><body><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar"><div class="toggle-sidebar-info text-center"><span data-toggle="Toggle article">Toggle site</span><hr></div><div class="sidebar-toc"><div class="sidebar-toc__title">Catalog</div><div class="sidebar-toc__progress"><span class="progress-notice">You've read</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar"></div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#背景"><span class="toc-number">1.</span> <span class="toc-text">背景</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#先上个动图"><span class="toc-number">2.</span> <span class="toc-text">先上个动图</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#开始正题"><span class="toc-number">3.</span> <span class="toc-text">开始正题</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#上方Nav"><span class="toc-number">3.1.</span> <span class="toc-text">上方Nav</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#下方菜单"><span class="toc-number">3.2.</span> <span class="toc-text">下方菜单</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#动画"><span class="toc-number">3.3.</span> <span class="toc-text">动画</span></a></li></ol></li></ol></div></div><div class="author-info hide"><div class="author-info__avatar text-center"><img src="http://p5sf6v0wz.bkt.clouddn.com/avatar.jpg"></div><div class="author-info__name text-center">AddOneG</div><div class="author-info__description text-center">我本嘉宾，何惧无笙</div><hr><div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="/archives"><span class="pull-left">Articles</span><span class="pull-right">43</span></a><a class="author-info-articles__tags article-meta" href="/tags"><span class="pull-left">Tags</span><span class="pull-right">31</span></a><a class="author-info-articles__categories article-meta" href="/categories"><span class="pull-left">Categories</span><span class="pull-right">21</span></a></div><hr><div class="author-info-links"><div class="author-info-links__title text-center">友情链接</div><a class="author-info-links__name text-center" href="https://blog.triplez.cn/" target="_blank">TripleZ</a><a class="author-info-links__name text-center" href="http://karlrixon.link/" target="_blank">karlrixon</a><a class="author-info-links__name text-center" href="http://qrzbing.cn/" target="_blank">a-Lie-Z</a><a class="author-info-links__name text-center" href="https://primykq.top/" target="_blank">Primykq</a><a class="author-info-links__name text-center" href="https://blog.zeddyu.info/" target="_blank">Zedd</a><a class="author-info-links__name text-center" href="https://yuwenjie.cc/" target="_blank">Seiry</a><a class="author-info-links__name text-center" href="https://mountainlovers.github.io/" target="_blank">Mountain_lovers</a><a class="author-info-links__name text-center" href="https://blog.rexskz.info/" target="_blank">Rex</a></div></div></div><div id="content-outer"><div class="plain" id="top-container"><div id="page-header"><span class="pull-left"> <a id="site-name" href="/">AddOneG</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right menus"><a class="site-page" href="/">主页</a><a class="site-page" href="/archives">时间轴</a><a class="site-page" href="/tags">标签</a><a class="site-page" href="/categories">分类</a></span></div></div><div class="layout" id="content-inner"><article id="post"><div class="plain" id="post-title">微信小程序实现折叠展开菜单</div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2018-04-07</time><span class="post-meta__separator">|</span><i class="fa fa-inbox" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/微信小程序/"> 微信小程序</a><i class="fa fa-angle-right post-meta__separator" aria-hidden="true"></i><i class="fa fa-inbox" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/微信小程序/UI/"> UI</a><span class="post-meta__separator">|</span><span class="post-meta-wordcount"><span>Word count: </span><span class="word-count">606</span><span class="post-meta__separator">|</span><span>Reading time: 2 min</span></span></div><div id="post-content"><h2 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h2><p>在这篇文章<a href="https://juejin.im/post/5aa62d3bf265da239b4112b3" target="_blank" rel="noopener">《2018年设计趋势指南》</a>中发现一款菜单不错，就想着用微信小程序实现</p>
<h2 id="先上个动图"><a href="#先上个动图" class="headerlink" title="先上个动图"></a>先上个动图</h2><p><img src="http://p5sf6v0wz.bkt.clouddn.com/menu.gif" width="50%" height="50%"></p>
<h2 id="开始正题"><a href="#开始正题" class="headerlink" title="开始正题"></a>开始正题</h2><h3 id="上方Nav"><a href="#上方Nav" class="headerlink" title="上方Nav"></a>上方Nav</h3><p>基本<code>flex</code>布局再加个<code>padding</code>不需要多讲吧?</p>
<blockquote>
<p>提一下，微信小程序里input的placeholder样式是写在<code>placeholder-style</code>里或使用<code>placeholder-class</code></p>
</blockquote>
<h3 id="下方菜单"><a href="#下方菜单" class="headerlink" title="下方菜单"></a>下方菜单</h3><ul>
<li>每个小卡片遵从<code>flex</code>布局，设置<code>width: 50%</code>，别忘了<code>flex-wrap: wrap</code></li>
<li>每个小卡片内部同为<code>flex</code>布局并设置垂直居中，想了想还是科普下:</li>
</ul>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.main-view-item</span>&#123;</span><br><span class="line">  <span class="attribute">display</span>: flex;</span><br><span class="line">  <span class="attribute">justify-content</span>: center;</span><br><span class="line">  <span class="attribute">align-items</span>: center;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">50%</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>flex真他娘的好用</p>
</blockquote>
<p>至于里面的图片是从<a href="http://www.iconfont.cn/" target="_blank" rel="noopener">iconfont</a>上拿的，调这几个配色的时间是我布局时间的几十倍….</p>
<h3 id="动画"><a href="#动画" class="headerlink" title="动画"></a>动画</h3><blockquote>
<p>微信小程序的动画只能用JS，常规手段不可用，来个头脑风暴hack起来</p>
</blockquote>
<p>观察每个卡片的折叠方向后，为每个卡片添加初始<code>rotate</code>使其反向折叠，我在这里定义了两个Class</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.rotateX90</span>&#123;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">rotateX</span>(-90deg);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.rotateY90</span>&#123;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">rotateY</span>(-90deg);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>好了这样就看不到卡片了，然后给菜单按钮添加点击事件改变卡片的rotate(动态改变Class)就Ojbk啦,就像这样</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">'main-view-item rotateX90 item1 &#123;&#123;item1Style&#125;&#125;'</span> <span class="attr">animation</span>=<span class="string">'&#123;&#123;item1&#125;&#125;'</span>&gt;</span><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>实际情况应该用<code>wx:for</code>进行循环渲染</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> duration = <span class="number">150</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> item1 = wx.createAnimation(&#123;</span><br><span class="line">  duration: duration,</span><br><span class="line">  transformOrigin: <span class="string">'0 0 0'</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">item1.rotateX(<span class="number">90</span>).step()</span><br><span class="line"></span><br><span class="line"><span class="keyword">this</span>.setData(&#123;</span><br><span class="line">  item1: item1,</span><br><span class="line">  item1Style: <span class="string">'item1Style'</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>这里注意调整<code>transformOrigin</code>来控制折叠方向，对于后面的卡片在<code>createAnimation</code>中添加<code>delay</code>字段即可(差为<code>duration</code>的等差数列)</p>
<blockquote>
<p>是不是很简单嗯?</p>
</blockquote>
<p>至于菜单的收回，代码和展开差不多，就是反过来而已，不过有些展开的顺序和<code>transformOrigin</code>需要注意，这里还是贴一个代码吧:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> duration = <span class="number">150</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> item3 = wx.createAnimation(&#123;</span><br><span class="line">  duration: duration,</span><br><span class="line">  transformOrigin: <span class="string">'100% 100% 0'</span>,</span><br><span class="line">  delay: duration * <span class="number">2</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">item1.rotateX(<span class="number">90</span>).step()</span><br><span class="line"></span><br><span class="line"><span class="keyword">this</span>.setData(&#123;</span><br><span class="line">  item3: item3,</span><br><span class="line">  item3Style: <span class="string">''</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>另外我在<code>data</code>里设置了两个变量<code>isShow</code>和<code>isShowing</code>来判断菜单是否展开或者正在展开，来控制点击事件，差不多像这样</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">handleClick()&#123;</span><br><span class="line">  <span class="keyword">if</span>(<span class="keyword">this</span>.data.isShowing)</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span>(!<span class="keyword">this</span>.data.isShow)</span><br><span class="line">    <span class="keyword">this</span>.showMenu()</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    <span class="keyword">this</span>.hideMenu()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>在动画完成后对<code>isShow</code>和<code>isShowing</code>进行修改即可</p>
<blockquote>
<p>欢迎有更好想法的朋友进行讨论~</p>
</blockquote>
</div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="mailto:undefined">AddOneG</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="http://yoursite.com/2018/04/07/微信小程序实现折叠展开菜单/">http://yoursite.com/2018/04/07/微信小程序实现折叠展开菜单/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/前端/">前端</a><a class="post-meta__tags" href="/tags/微信小程序/">微信小程序</a></div><nav id="pagination"><div class="prev-post pull-left"><a href="/2018/04/12/JavaScript设计模式/"><i class="fa fa-chevron-left">  </i><span>JavaScript设计模式</span></a></div><div class="next-post pull-right"><a href="/2018/04/03/一个前端开发者的自我折磨-UI/"><span>一个前端开发者的自我折磨(UI)</span><i class="fa fa-chevron-right"></i></a></div></nav></div></div><footer><div class="layout" id="footer"><div class="copyright">&copy;2017 - 2018 By AddOneG</div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="/js/third-party/anime.min.js"></script><script src="/js/third-party/jquery.min.js"></script><script src="/js/third-party/jquery.fancybox.min.js"></script><script src="/js/third-party/velocity.min.js"></script><script src="/js/third-party/velocity.ui.min.js"></script><script src="/js/utils.js?version=1.5.3"></script><script src="/js/fancybox.js?version=1.5.3"></script><script src="/js/sidebar.js?version=1.5.3"></script><script src="/js/copy.js?version=1.5.3"></script><script src="/js/fireworks.js?version=1.5.3"></script><script src="/js/transition.js?version=1.5.3"></script><script src="/js/scroll.js?version=1.5.3"></script><script src="/js/head.js?version=1.5.3"></script></body></html>